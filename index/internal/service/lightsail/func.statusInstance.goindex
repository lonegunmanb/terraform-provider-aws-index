package github.com/hashicorp/terraform-provider-aws/internal/service/lightsail
import (
	"context"
	"fmt"
	"log"
	"strconv"

	"github.com/aws/aws-sdk-go-v2/aws"
	"github.com/aws/aws-sdk-go-v2/service/lightsail"
	"github.com/hashicorp/terraform-provider-aws/internal/retry"
)
func statusInstance(conn *lightsail.Client, iName *string) retry.StateRefreshFunc {
	return func(ctx context.Context) (any, string, error) {
		in := &lightsail.GetInstanceStateInput{
			InstanceName: iName,
		}

		iNameValue := aws.ToString(iName)

		log.Printf("[DEBUG] Checking if Lightsail Instance (%s) is in a ready state.", iNameValue)

		out, err := conn.GetInstanceState(ctx, in)

		if err != nil {
			return out, "FAILED", err
		}

		if out.State == nil {
			return nil, "Failed", fmt.Errorf("retrieving Instance info for (%s)", iNameValue)
		}

		log.Printf("[DEBUG] Lightsail Instance (%s) State is currently (%s)", iNameValue, *out.State.Name)
		return out, *out.State.Name, nil
	}
}
