package github.com/hashicorp/terraform-provider-aws/internal/service/dynamodb
import (
	"maps"

	"github.com/hashicorp/terraform-plugin-sdk/v2/helper/schema"
)
func stripGSIUpdatableAttributes(in map[string]any) map[string]any {
	attrs := stripCapacityAttributes(in)
	attrs = stripNonKeyAttributes(attrs)
	attrs = stripOnDemandThroughputAttributes(attrs)
	attrs = stripWarmThroughputAttributes(attrs)
	// Remove empty hash_keys/range_keys to avoid false positive diffs
	if hks, ok := attrs["hash_keys"]; ok {
		if l, ok := hks.([]any); ok && len(l) == 0 {
			delete(attrs, "hash_keys")
		}
	}
	if rks, ok := attrs["range_keys"]; ok {
		if set, ok := rks.(*schema.Set); ok && set.Len() == 0 {
			delete(attrs, "range_keys")
		}
	}

	return attrs
}
