package github.com/hashicorp/terraform-provider-aws/internal/tfresource
import (
	"errors"
	"fmt"
	"iter"

	sdkretry "github.com/hashicorp/terraform-plugin-sdk/v2/helper/retry"
	"github.com/hashicorp/terraform-provider-aws/internal/retry"
	tfslices "github.com/hashicorp/terraform-provider-aws/internal/slices"
	"github.com/hashicorp/terraform-provider-aws/internal/types/option"
)
func AssertSingleValueResultIterErr[T any](i iter.Seq2[T, error]) (*T, error) {
	next, stop := iter.Pull2(i)
	defer stop()

	v, err, ok := next()
	if !ok {
		return nil, NewEmptyResultError()
	}

	if err != nil {
		return nil, err
	}

	_, err, ok = next()
	if !ok {
		return &v, nil
	}

	if err != nil {
		return nil, err
	}
	n := 2
	for {
		_, err, ok = next()
		if !ok {
			break
		}
		if err != nil {
			return nil, err
		}
		n++
	}
	return nil, NewTooManyResultsError(n, nil)
}
