package github.com/hashicorp/terraform-provider-aws/internal/actionwait
import (
	"context"
	"errors"
	"slices"
	"time"

	"github.com/hashicorp/terraform-provider-aws/internal/backoff"
)
func handleProgressReport[T any](opts Options[T], fr FetchResult[T], start time.Time, deadline time.Time, attempt uint, lastProgress *time.Time) {
	if opts.ProgressSink == nil || opts.ProgressInterval <= 0 {
		return
	}

	if lastProgress.IsZero() || time.Since(*lastProgress) >= opts.ProgressInterval {
		nextPoll := opts.Interval.NextPoll(attempt)
		opts.ProgressSink(anyFetchResult(fr), ProgressMeta{
			Attempt:    attempt,
			Elapsed:    time.Since(start),
			Remaining:  maxDuration(0, time.Until(deadline)),
			Deadline:   deadline,
			NextPollIn: nextPoll,
		})
		*lastProgress = time.Now()
	}
}
