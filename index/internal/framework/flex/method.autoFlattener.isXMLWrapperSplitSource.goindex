package github.com/hashicorp/terraform-provider-aws/internal/framework/flex
import (
	"context"
	"fmt"
	"iter"
	"reflect"
	"strings"
	"time"

	smithydocument "github.com/aws/smithy-go/document"
	"github.com/hashicorp/terraform-plugin-framework-timetypes/timetypes"
	"github.com/hashicorp/terraform-plugin-framework/attr"
	"github.com/hashicorp/terraform-plugin-framework/diag"
	"github.com/hashicorp/terraform-plugin-framework/path"
	"github.com/hashicorp/terraform-plugin-framework/types"
	"github.com/hashicorp/terraform-plugin-framework/types/basetypes"
	"github.com/hashicorp/terraform-plugin-log/tflog"
	fwtypes "github.com/hashicorp/terraform-provider-aws/internal/framework/types"
	tfreflect "github.com/hashicorp/terraform-provider-aws/internal/reflect"
	tfsmithy "github.com/hashicorp/terraform-provider-aws/internal/smithy"
	"github.com/shopspring/decimal"
)
func (flattener autoFlattener) isXMLWrapperSplitSource(structType reflect.Type) bool {
	hasValidItems := false
	hasValidQuantity := false
	hasOtherFields := false

	for i := 0; i < structType.NumField(); i++ {
		field := structType.Field(i)
		fieldName := field.Name
		fieldType := field.Type

		switch fieldName {
		case getXMLWrapperSliceFieldName(structType):
			// Items must be a slice to be a valid XML wrapper
			if fieldType.Kind() == reflect.Slice {
				hasValidItems = true
			}
		case xmlWrapperFieldQuantity:
			// Quantity must be *int32 to be a valid XML wrapper
			if fieldType == reflect.TypeOf((*int32)(nil)) {
				hasValidQuantity = true
			}
		default:
			// Any other field suggests this is a complex structure that should be split
			hasOtherFields = true
		}
	}

	// Must have properly typed Items/Quantity (XML wrapper pattern) plus other fields to be a split candidate
	return hasValidItems && hasValidQuantity && hasOtherFields
}
